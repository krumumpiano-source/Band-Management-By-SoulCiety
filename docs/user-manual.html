<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>คู่มือการใช้งาน — Band Management By SoulCiety</title>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700&family=Sarabun:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/theme.css">
  <link rel="stylesheet" href="css/nav.css">
  <link rel="stylesheet" href="css/compat.css">
  <style>
    .manual-layout{display:grid;grid-template-columns:240px 1fr;gap:var(--spacing-xl)}
    @media(max-width:768px){.manual-layout{grid-template-columns:1fr}}
    .manual-toc{position:sticky;top:80px}
    .toc-item{padding:var(--spacing-xs) var(--spacing-md);border-left:3px solid transparent;font-size:var(--text-sm);color:var(--premium-text-muted);cursor:pointer;transition:all .15s;display:block;text-decoration:none}
    .toc-item:hover,.toc-item.active{border-left-color:var(--premium-gold);color:var(--premium-gold);background:var(--premium-off-white)}
    .manual-section{margin-bottom:var(--spacing-2xl)}
    .manual-section h2{font-size:var(--text-xl);font-weight:700;border-bottom:2px solid var(--premium-gold);padding-bottom:var(--spacing-sm);margin-bottom:var(--spacing-lg)}
    .manual-section h3{font-size:var(--text-base);font-weight:600;color:var(--premium-gold);margin-top:var(--spacing-lg);margin-bottom:var(--spacing-sm)}
    .manual-section p,.manual-section li{font-size:var(--text-base);line-height:1.8;color:var(--premium-text)}
    .manual-section ul{padding-left:var(--spacing-xl)}
    .step-list{counter-reset:step;list-style:none;padding:0}
    .step-list li{counter-increment:step;padding:var(--spacing-sm) var(--spacing-md) var(--spacing-sm) 48px;margin-bottom:var(--spacing-sm);background:var(--premium-off-white);border-radius:var(--radius-md);position:relative}
    .step-list li::before{content:counter(step);position:absolute;left:12px;top:50%;transform:translateY(-50%);width:24px;height:24px;border-radius:var(--radius-full);background:var(--premium-gold);color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700}
    .tip-box{background:#ebf8ff;border-left:4px solid #3182ce;border-radius:0 var(--radius-md) var(--radius-md) 0;padding:var(--spacing-md);margin:var(--spacing-md) 0;font-size:var(--text-sm)}
    .warn-box{background:#fffbeb;border-left:4px solid var(--premium-gold);border-radius:0 var(--radius-md) var(--radius-md) 0;padding:var(--spacing-md);margin:var(--spacing-md) 0;font-size:var(--text-sm)}
    kbd{background:var(--premium-off-white);border:1px solid var(--premium-medium-gray);border-radius:4px;padding:1px 6px;font-size:var(--text-xs);font-family:monospace}
  </style>
</head>
<body>
  <div id="mainNav"></div>
  <div id="toast"></div>
  <main>
    <div class="container">
      <div class="page-header"><h1 class="page-title">📖 <span data-i18n="nav_manual">คู่มือการใช้งาน</span></h1>
        <button class="btn btn-secondary" onclick="window.print()">🖨️ พิมพ์</button>
      </div>
      <div class="manual-layout">
        <!-- TOC -->
        <div>
          <div class="card manual-toc">
            <div class="card-header" style="padding-bottom:var(--spacing-sm)"><h3 class="card-title" style="font-size:var(--text-sm)">สารบัญ</h3></div>
            <a class="toc-item" href="#sec-start">เริ่มต้นใช้งาน</a>
            <a class="toc-item" href="#sec-members">สมาชิกวง</a>
            <a class="toc-item" href="#sec-schedule">ตารางงาน</a>
            <a class="toc-item" href="#sec-payroll">เบิกค่าตัว</a>
            <a class="toc-item" href="#sec-songs">เพลง / เซ็ตลิสต์</a>
            <a class="toc-item" href="#sec-quotation">ใบเสนอราคา</a>
            <a class="toc-item" href="#sec-equipment">อุปกรณ์</a>
            <a class="toc-item" href="#sec-clients">ลูกค้า</a>
            <a class="toc-item" href="#sec-fund">กองกลาง</a>
            <a class="toc-item" href="#sec-faq">คำถามที่พบบ่อย</a>
          </div>
        </div>
        <!-- Content -->
        <div>
          <div class="card">
            <section class="manual-section" id="sec-start">
              <h2>🚀 เริ่มต้นใช้งาน</h2>
              <h3>1. Setup ระบบครั้งแรก</h3>
              <ol class="step-list">
                <li>เปิด Google Sheets Spreadsheet ของระบบ</li>
                <li>คลิก เมนู <strong>"🎵 SoulCiety"</strong> → <strong>"Setup ระบบ"</strong></li>
                <li>รอระบบสร้างชีตข้อมูลทั้งหมดให้อัตโนมัติ</li>
                <li>กลับมาที่เมนู → <strong>"เปิด Web App"</strong></li>
                <li>สมัครบัญชีผู้ใช้งานครั้งแรก พร้อมตั้งชื่อวง</li>
              </ol>
              <div class="tip-box">💡 การ Setup ต้องทำครั้งเดียวเท่านั้น ระบบจะจำข้อมูลทั้งหมดใน Google Sheets</div>
              <h3>2. การล็อกอิน</h3>
              <p>ใช้อีเมลและรหัสผ่านที่สมัครไว้เพื่อเข้าสู่ระบบ หรือเลือก <kbd>เข้าโหมดทดสอบ</kbd> เพื่อทดลองใช้งาน</p>
            </section>

            <section class="manual-section" id="sec-members">
              <h2>👥 สมาชิกวง</h2>
              <p>ระบบสมาชิกช่วยให้คุณบันทึกข้อมูลนักดนตรีทุกคนในวง</p>
              <h3>เพิ่มสมาชิก</h3>
              <ol class="step-list">
                <li>ไปที่เมนู <strong>ข้อมูลวงดนตรี</strong></li>
                <li>กดปุ่ม <strong>+ เพิ่มสมาชิก</strong></li>
                <li>กรอกชื่อ, ตำแหน่ง, เบอร์โทร, อีเมล และอัตราค่าตัว</li>
                <li>กด <strong>บันทึก</strong></li>
              </ol>
              <div class="warn-box">⚠️ อัตราค่าตัวที่ตั้งไว้จะใช้เป็นค่าเริ่มต้นในการคำนวณ สามารถปรับเปลี่ยนได้ต่องาน</div>
            </section>

            <section class="manual-section" id="sec-schedule">
              <h2>📅 ตารางงาน</h2>
              <p>บันทึกและติดตามงานแสดงทั้งหมดในปฏิทิน</p>
              <ul>
                <li>คลิกที่วันในปฏิทินเพื่อ<strong>เพิ่มงานใหม่</strong></li>
                <li>คลิกที่ชื่องานที่มีอยู่เพื่อ<strong>แก้ไข</strong></li>
                <li>ตั้งสถานะงานเป็น: ยืนยัน / รอการยืนยัน / ยกเลิก</li>
              </ul>
            </section>

            <section class="manual-section" id="sec-payroll">
              <h2>💳 เบิก-จ่ายค่าตัว</h2>
              <ol class="step-list">
                <li>เลือกงานจากรายการ Dropdown</li>
                <li>ทำเครื่องหมายว่าใครมา/ขาด/มาแทน</li>
                <li>ระบบคำนวณค่าตัวต่อคนให้อัตโนมัติ</li>
                <li>กด <strong>บันทึก</strong> เพื่อเก็บประวัติ</li>
              </ol>
            </section>

            <section class="manual-section" id="sec-songs">
              <h2>🎼 เพลง / เซ็ตลิสต์</h2>
              <p>จัดการคลังเพลงของวงและสร้างเซ็ตลิสต์สำหรับแต่ละงาน</p>
              <ul>
                <li><strong>รายการเพลง</strong>: เพิ่ม/แก้ไข/ลบเพลง พร้อม Chord, Key, Tempo</li>
                <li><strong>เซ็ตลิสต์</strong>: ลากเพลงมาจัดเซ็ต 1-3 ตามงาน</li>
                <li><strong>วิเคราะห์เพลง</strong>: ดูกราฟสัดส่วน Key/Tempo/Genre</li>
              </ul>
            </section>

            <section class="manual-section" id="sec-quotation">
              <h2>📄 ใบเสนอราคา</h2>
              <ol class="step-list">
                <li>ไปที่เมนู <strong>ใบเสนอราคา</strong></li>
                <li>กด <strong>+ ใบเสนอราคาใหม่</strong></li>
                <li>กรอกข้อมูลลูกค้า, วันที่, รายการ, ราคา</li>
                <li>ระบบคำนวณ VAT และยอดรวมให้อัตโนมัติ</li>
                <li>กด <strong>📄 PDF</strong> เพื่อสร้าง PDF บน Google Drive</li>
              </ol>
            </section>

            <section class="manual-section" id="sec-equipment">
              <h2>🎸 อุปกรณ์/เครื่องดนตรี</h2>
              <p>ติดตามสถานะอุปกรณ์ทุกชิ้นในวง</p>
              <ul>
                <li>กรองตามประเภท: เครื่องดนตรี, เสียง/PA, แสง, อุปกรณ์เสริม</li>
                <li>บันทึกสถานะ: ปกติ / ซ่อม / เสียหาย</li>
                <li>เก็บ Serial Number และราคาซื้อเพื่อประกัน</li>
              </ul>
            </section>

            <section class="manual-section" id="sec-clients">
              <h2>🤝 ลูกค้า/ผู้จ้าง</h2>
              <p>ฐานข้อมูลลูกค้าที่เคยหรือกำลังจะจ้างวง</p>
              <ul>
                <li>เก็บข้อมูลติดต่อ: โทร, อีเมล, LINE ID</li>
                <li>ระบบนับจำนวนงานและรายรับรวมต่อลูกค้าอัตโนมัติ</li>
              </ul>
            </section>

            <section class="manual-section" id="sec-fund">
              <h2>🏦 กองกลางวง</h2>
              <p>จัดการรายรับ-รายจ่ายของกองกลางวงดนตรี</p>
              <ul>
                <li>เพิ่มรายการรายรับ (เงินกองกลางจากงาน)</li>
                <li>เพิ่มรายการรายจ่าย (ค่าซ้อม, อุปกรณ์, ค่าเดินทาง)</li>
                <li>ดูยอดคงเหลือปัจจุบัน</li>
              </ul>
            </section>

            <section class="manual-section" id="sec-faq">
              <h2>❓ คำถามที่พบบ่อย</h2>
              <h3>ข้อมูลหายหลัง Session หมดอายุ?</h3>
              <p>ข้อมูลทั้งหมดบันทึกใน Google Sheets ตลอดเวลา ไม่มีการหายแน่นอน ลองล็อกอินใหม่</p>
              <h3>PDF ออกมาไม่ถูกต้อง?</h3>
              <p>ตรวจสอบว่า GAS มีสิทธิ์เข้าถึง Google Drive ใน OAuth Scopes</p>
              <h3>ต้องการเพิ่ม Admin คนใหม่?</h3>
              <p>ไปที่ <strong>Admin Panel</strong> → จัดการผู้ใช้ → เปลี่ยน Role</p>
            </section>
          </div>
        </div>
      </div>
    </div>
  </main>
  <script src="js/i18n.js"></script>
  <script src="js/app.js"></script>
  <script src="js/nav.js"></script>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    requireAuth(); renderMainNav('mainNav'); applyTranslations();
  });
  </script>
</body>
</html>
